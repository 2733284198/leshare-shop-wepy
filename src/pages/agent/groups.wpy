<template>
  <Loading :init.sync="init"/>

  <view wx:if="{{init}}">

    <view class="column">
      <block wx:for="{{page.list}}" wx:key="index" wx:for-item="item">
        <view class="row-between item-box">
          <view class="customer-box row">
            <image class="avatar-box" src="{{item.customer.avatarUrl}}"/>
            <view class="column name-box">
              <text class="ml20 inline">{{item.customer.nickName}}</text>
              <text class="ml20">{{item.customer.phone ? item.customer.phone : item.phone}}</text>
            </view>
          </view>
          <view class="column time-bonus-box">
            <text class="muted sm">{{item.createTime}}</text>
            <view class="row">
              <text>余额：</text>
              <text class="primary">{{item.balance}}</text>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- 加载提示 -->
    <Loadmore :page.sync="page"/>

  </view>

  <!--占位符-->
  <Placeholder :show.sync="isPageEmpty" message="您还没有相关团队信息"/>
</template>

<script>
  import wepy from 'wepy'
  import base from '../../mixins/base';
  import pagination from '../../mixins/pagination.wpy';
  import Placeholder from '../../components/common/placeholder';
  import Loadmore from '../../components/weui/loadmore';
  import Loading from '../../components/common/loading';
  import agent from '../../api/agent';

  export default class Groups extends wepy.page {
    data = {
      init: false,
      page: {}
    };
    async onLoad ({id}) {
      console.info(id);
      this.page = await agent.agentGroups(id);
      await this.next();
    }
    methods = {};
    computed = {};
    components = {
      Placeholder: Placeholder,
      Loadmore: Loadmore,
      Loading: Loading
    };
    mixins = [base, pagination];
    config = {
      navigationBarTitleText: '我的团队',
      enablePullDownRefresh: true
    };
  }
</script>

<style lang="scss">
  @import "../../styles/variable";
  .item-box{
    padding: 18rpx;
    margin: 10rpx 10rpx 0;
    border-radius: 30rpx;
    background-color: white;
  }
  .customer-box{
    align-items: center;
    .avatar-box{
      width: 80rpx;
      height: 80rpx;
      border: $border;
      border-radius: 40rpx;
    }
    .name-box{
      width: 350rpx;
    }
  }
  .time-bonus-box{
    align-items: flex-end;
  }
</style>
